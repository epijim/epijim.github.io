<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Scottish independence polls • James Black</title>
    <meta name="description" content="Smoothing six Scottish independence polls six days out from the vote.">
    <meta name="keywords" content="uk, politics">
    
    
    	<!-- Twitter Cards -->
	<meta name="twitter:title" content="Scottish independence polls">
	<meta name="twitter:description" content="Smoothing six Scottish independence polls six days out from the vote.">
	
	
	
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:image" content="http://epijim.uk/images/independence_feature.jpeg">
	
	<!-- Open Graph -->
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Scottish independence polls">
	<meta property="og:description" content="Smoothing six Scottish independence polls six days out from the vote.">
	<meta property="og:url" content="http://epijim.uk/blog/independence/">
	<meta property="og:site_name" content="James Black">
    <link rel="author" href="https://plus.google.com/https://plus.google.com/112022213613617220776/"/>

    <link rel="canonical" href="http://epijim.uk/blog/independence/">

    <link href="http://epijim.uk/atom.xml" type="application/atom+xml" rel="alternate" title="James Black Atom Feed">
    <link href="http://epijim.uk/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cleartype" content="on">

    <style>
    .sliding-menu-content {
      top: 0;
      right: 0;
      text-align: center;
      visibility: hidden;
      height: 100%;
      width: 100%;
      -webkit-transform: translateX(100%);
      -moz-transform: translateX(100%);
      -ms-transform: translateX(100%);
      -o-transform: translateX(100%);
      transform: translateX(100%);
    }
    </style>

    <link rel="stylesheet" href="http://epijim.uk/css/main.css">
    <!-- HTML5 Shiv and Media Query Support for IE -->
    <!--[if lt IE 9]>
      <script src="http://epijim.uk/js/vendor/html5shiv.min.js"></script>
      <script src="http://epijim.uk/js/vendor/respond.min.js"></script>
    <![endif]-->

  </head>

  <body>
    <header id="masthead">
  <div class="inner-wrap">
    <a href="http://epijim.uk" class="site-title">James Black</a>
    <nav role="navigation" class="menu top-menu">
        <ul class="menu-item">
	<li class="home"><a href="/">James Black</a></li>
	
    
        
    
    <li><a href="http://epijim.uk/about/" >About</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/my-papers/" >Papers</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/code/" >Code</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/blog/" >Blog</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/courses/" >Courses</a></li>
  
</ul>
    </nav>
  </div><!-- /.inner-wrap -->
</header><!-- /.masthead -->
    <nav role="navigation" class="js-menu sliding-menu-content">
	<ul class="menu-item">
		<li>
      
        
      
			<a href="http://epijim.uk/about/"><img src="http://epijim.uk/images/about_thumb.jpeg" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/about/" class="title">About</a>
			<p class="excerpt">Get more information on, or contact, James Black.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/my-papers/"><img src="http://epijim.uk/images/papers_thumb.png" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/my-papers/" class="title">Papers</a>
			<p class="excerpt">My published journal articles.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/code/"><img src="http://epijim.uk/images/code_thumb.png" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/code/" class="title">Code</a>
			<p class="excerpt">A collection of code snippets I think are really useful.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/blog/"><img src="http://epijim.uk/images/blog_thumb.jpg" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/blog/" class="title">Blog</a>
			<p class="excerpt">My data based blog.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/courses/"><img src="http://epijim.uk/images/courses.jpg" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/courses/" class="title">Courses</a>
			<p class="excerpt">Courses I've done relating to R or coding</p>
		</li>
	</ul>
</nav>
<button type="button" class="js-menu-trigger sliding-menu-button menulines-button x2" role="button" aria-label="Toggle Navigation">
	<span class="menulines"></span>
</button>

<div class="js-menu-screen menu-screen"></div>

    <div id="page-wrapper">
      <!--[if lt IE 9]><div class="upgrade notice-danger"><strong>Your browser is quite old!</strong> Why not <a href="http://whatbrowser.org/">upgrade to a newer one</a> to better enjoy this site?</div><![endif]-->

      <div id="main" role="main">	
	<article class="wrap" itemscope itemtype="http://schema.org/Article">
			<div class="page-feature-header overlay">
			
			<div class="page-image">
				<img src="http://epijim.uk/images/independence_feature.jpeg" class="page-feature-image" alt="Scottish independence polls" itemprop="image">
				<div class="image-credit">Image source: <a href="http://herneman.blogspot.co.uk" itemprop="citation">Herneman</a></div><!-- /.image-credit -->
			</div><!-- /.page-image -->
			
			<div class="page-title">
        	<h1><span>Scottish independence polls</span></h1>
        	<div class="page-meta">
  
    <span>Filed under: <a href="/tag/uk/" title="uk" rel="tag">uk</a>, <a href="/tag/politics/" title="politics" rel="tag">politics</a></span>
  
</div><!-- /.page-meta -->
			</div><!-- /.page-title -->
      	</div><!-- /.page-image-media -->
		<div class="inner-wrap">
			<nav class="toc"></nav><!-- /.toc -->
			<div id="content" class="page-content" itemprop="articleBody">
				<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<p>I’m currently doing an online course focusing on data management.<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> As part of that course
 I’m learning how to scrape information from websites, using R, when they don’t give you an API 
 for easy access. To practice what I learnt, I had a go at scraping the data from the BBC’s 
 Scottish independence poll tracker. After checking the page source, I saw the data in a javascript 
 file.<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup></p>

<p>As it took me over an hour to figure out how to read that file, I thought I should probably
 plot the hard won data.</p>

<h2 id="the-raw-data">The raw data</h2>

<p>Below is the data I pulled from that file. It contains 58 polls taken by six different companies.
 The first plot is just the raw data as a line graph.</p>

<figure>
	<a href="/images/independence_1_diff.png"><img src="/images/independence_1_diff.png" /></a>
	<figcaption>The six survey companies with lines connecting each repeated survey.</figcaption>
</figure>

<h2 id="simply-smoothed">Simply smoothed</h2>

<p>Again, the raw data, but this time smoothing the lines using locally weighted regression.</p>

<figure>
	<a href="/images/independence_2_smooth.png"><img src="/images/independence_2_smooth.png" /></a>
	<figcaption>Same as before, but now the lines are smoothed within each company. So each line is completely independent.</figcaption>
</figure>

<h2 id="treating-the-polls-as-not-independent">Treating the polls as not independent</h2>

<p>For this last figure, I’ve assumed that the polls are related to each other using a
 multilevel model. As these polls are quite different in their methodology, I’ve let the slopes 
 and intercepts vary for survey companies. Days till the vote is treated as something that 
 is constant across the companies (I didn’t look into whether this is actually true). 
 As the slopes don’t look linear, I’ve transformed the time variable in the 
 model. The residuals get quite iffy when you get close to the voting day, so the model shouldn’t 
 be taken seriously (having said that - the model suggests that 6 days out the <em>‘better together’</em> group 
 have a lead of 1.1%).</p>

<p>The model:</p>

<script type="math/tex; mode=display">(No-Yes)_{ij} = \beta _{0} + \beta_{1}Company_{ij}+\beta_{2}DaysTillVote_{ij} + u_{0j} + u_{1j}Company_{ij}+e_{ij}</script>

<figure>
	<a href="/images/independence_3_model.png"><img src="/images/independence_3_model.png" /></a>
	<figcaption>Here each line is able to have it's own slope, and starting height, but all the slopes are assumed to come from the same wider population of possible survey methodologies (companies).</figcaption>
</figure>

<h2 id="the-data-source">The data source</h2>

<p>This data was pulled from the .js file that runs the <a href="http://www.bbc.co.uk/news/events/scotland-decides/poll-tracker">BBC poll tracker, which is here</a>.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>The course https://www.coursera.org/course/getdata <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>The js file I was practicing my parsing skills on http://news.bbcimg.co.uk/news/special/2014/newsspec_7419/english/js/data/polls.js <a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

				<hr />
				<footer class="page-footer">
					


<div class="author-image">
	<img src="http://epijim.uk/images/bio-photo.jpg" alt="James Black">
</div><!-- ./author-image -->
<div class="author-content">
	<h3 class="author-name" >Written by <a href="http://epijim.uk" itemprop="author">James Black</a></h3>
	<p class="author-bio">Reading Epidemiology at Jesus College, University of Cambridge.</p>
</div><!-- ./author-content -->
					<div class="inline-btn">
	<a class="btn-social twitter" href="https://twitter.com/intent/tweet?text=Scottish%20independence%20polls&amp;url=http://epijim.uk/blog/independence/&amp;via=" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i> Share on Twitter</a>
	<a class="btn-social facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://epijim.uk/blog/independence/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i> Share on Facebook</a>
	<a class="btn-social google-plus"  href="https://plus.google.com/share?url=http://epijim.uk/blog/independence/" target="_blank"><i class="fa fa-google-plus" aria-hidden="true"></i> Share on Google+</a>
</div><!-- /.share-this -->
					<div class="page-meta">
	<p>Updated <time datetime="2014-09-15T00:00:00Z" itemprop="datePublished">September 15, 2014</time></p>
</div><!-- /.page-meta -->
				</footer><!-- /.footer -->
				<div class="entry-related">
					<h4>Related Articles <a href="#" onclick="(function(btn){var z=document.createElement('script');document.subtomeBtn=btn;z.src='https://www.subtome.com/load.js';document.body.appendChild(z);})(this);_gaq.push(['_trackEvent', 'Link', 'Subscribe']);" data-subtome-resource="http://epijim.uk" data-subtome-feeds="http://feeds.feedburner.com/epijim"><i class="fa fa-rss fa-fw"></i></a></h4>
					<ul>
						
						<li><a href="http://epijim.uk/blog/when-cam-nice-app/">When is it nice in Cambridge (interactive app)?</a></li>
						
						<li><a href="http://epijim.uk/blog/when-cam-nice/">When is it nice in Cambridge?</a></li>
						
						<li><a href="http://epijim.uk/blog/pub-crawl/">Optimum pub crawl route through all 71 Cambridge pubs</a></li>
						
						<li><a href="http://epijim.uk/blog/pub-distances/">Distance to the nearest pub</a></li>
						
					</ul>
				</div><!-- /.entry-related -->
				<aside>
				<hr />
<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'jamesblack';

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
				</aside>
			</div><!-- /.content -->
		</div><!-- /.inner-wrap -->
		
	</article><!-- /.wrap -->
</div><!-- /#main -->



      <footer role="contentinfo" id="site-footer">
	<nav role="navigation" class="menu bottom-menu">
		<ul class="menu-item">
		
      
        
      
			<li><a href="http://epijim.uk/" >Home</a></li>
		
      
        
      
			<li><a href="http://epijim.uk/my-papers/" >Papers</a></li>
		
      
        
      
			<li><a href="http://epijim.uk/about/" >About</a></li>
		
      
        
      
			<li><a href="http://epijim.uk/terms/" >Legal</a></li>
		
		</ul>
	</nav><!-- /.bottom-menu -->
	<p class="copyright">&#169; 2014 <a href="http://epijim.uk">James Black</a> hosted by <a href="https://pages.github.com">Github</a> and powered by <a href="http://jekyllrb.com">Jekyll</a> + <a href="http://mmistakes.github.io/skinny-bones-jekyll/">Skinny Bones</a>.</p>
<!-- google analytics -->	
<script> 
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47906301-1', 'auto');
  ga('send', 'pageview');

</script>
</footer>
    </div>

    <script src="http://epijim.uk/js/vendor/jquery-1.9.1.min.js"></script>
    <script src="http://epijim.uk/js/main.js"></script>
    
    
    <script type="text/javascript">
      $('.toc').toc({
        'selectors': 'h2', //elements to use as headings
        'container': '.page-content', //element to find all selectors in
        'smoothScrolling': true, //enable or disable smooth scrolling on click
        'prefix': 'toc', //prefix for anchor tags and class names
        'onHighlight': function(el) {}, //called when a new section is highlighted 
        'highlightOnScroll': true, //add class to heading that is currently in focus
        'highlightOffset': 100, //offset to trigger the next headline
        'anchorName': function(i, heading, prefix) { //custom function for anchor name
          return prefix+i;
        },
        'headerText': function(i, heading, $heading) { //custom function building the header-item text
          return $heading.text();
        },
        'itemClass': function(i, heading, $heading, prefix) { //custom function for item class
          return $heading[0].tagName.toLowerCase();
        }
      });
    </script>
    

  </body>

</html>
