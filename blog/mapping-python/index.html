<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Mapping my google location data • James Black</title>
    <meta name="description" content="Mapping my google location data with python.">
    <meta name="keywords" content="r, python, geocoding">
    
    
    	<!-- Twitter Cards -->
	<meta name="twitter:title" content="Mapping my google location data">
	<meta name="twitter:description" content="Mapping my google location data with python.">
	
	
	
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:image" content="http://epijim.uk/images/mappython_feature.png">
	
	<!-- Open Graph -->
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Mapping my google location data">
	<meta property="og:description" content="Mapping my google location data with python.">
	<meta property="og:url" content="http://epijim.uk/blog/mapping-python/">
	<meta property="og:site_name" content="James Black">
    <link rel="author" href="https://plus.google.com/https://plus.google.com/112022213613617220776/"/>

    <link rel="canonical" href="http://epijim.uk/blog/mapping-python/">

    <link href="http://epijim.uk/atom.xml" type="application/atom+xml" rel="alternate" title="James Black Atom Feed">
    <link href="http://epijim.uk/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cleartype" content="on">

    <style>
    .sliding-menu-content {
      top: 0;
      right: 0;
      text-align: center;
      visibility: hidden;
      height: 100%;
      width: 100%;
      -webkit-transform: translateX(100%);
      -moz-transform: translateX(100%);
      -ms-transform: translateX(100%);
      -o-transform: translateX(100%);
      transform: translateX(100%);
    }
    </style>

    <link rel="stylesheet" href="http://epijim.uk/css/main.css">
    <!-- HTML5 Shiv and Media Query Support for IE -->
    <!--[if lt IE 9]>
      <script src="http://epijim.uk/js/vendor/html5shiv.min.js"></script>
      <script src="http://epijim.uk/js/vendor/respond.min.js"></script>
    <![endif]-->

  </head>

  <body>
    <header id="masthead">
  <div class="inner-wrap">
    <a href="http://epijim.uk" class="site-title">James Black</a>
    <nav role="navigation" class="menu top-menu">
        <ul class="menu-item">
	<li class="home"><a href="/">James Black</a></li>
	
    
        
    
    <li><a href="http://epijim.uk/my-papers/" >Papers</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/code/" >Code</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/blog/" >Blog</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/about/" >About</a></li>
  
</ul>
    </nav>
  </div><!-- /.inner-wrap -->
</header><!-- /.masthead -->
    <nav role="navigation" class="js-menu sliding-menu-content">
	<ul class="menu-item">
		<li>
      
        
      
			<a href="http://epijim.uk/my-papers/"><img src="http://epijim.uk/images/papers_thumb.png" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/my-papers/" class="title">Papers</a>
			<p class="excerpt">My published journal articles.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/code/"><img src="http://epijim.uk/images/code_thumb.png" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/code/" class="title">Code</a>
			<p class="excerpt">A collection of code snippets I think are really useful.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/blog/"><img src="http://epijim.uk/images/blog_thumb.jpg" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/blog/" class="title">Blog</a>
			<p class="excerpt">My data based blog.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/about/"><img src="http://epijim.uk/images/about_thumb.jpeg" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/about/" class="title">About</a>
			<p class="excerpt">Get more information on, or contact, James Black.</p>
		</li>
	</ul>
</nav>
<button type="button" class="js-menu-trigger sliding-menu-button menulines-button x2" role="button" aria-label="Toggle Navigation">
	<span class="menulines"></span>
</button>

<div class="js-menu-screen menu-screen"></div>

    <div id="page-wrapper">
      <!--[if lt IE 9]><div class="upgrade notice-danger"><strong>Your browser is quite old!</strong> Why not <a href="http://whatbrowser.org/">upgrade to a newer one</a> to better enjoy this site?</div><![endif]-->

      <div id="main" role="main">	
	<article class="wrap" itemscope itemtype="http://schema.org/Article">
			<div class="page-feature-header overlay">
			
			<div class="page-image">
				<img src="http://epijim.uk/images/mappython_feature.png" class="page-feature-image" alt="Mapping my google location data" itemprop="image">
				
			</div><!-- /.page-image -->
			
			<div class="page-title">
        	<h1><span>Mapping my google location data</span></h1>
        	<div class="page-meta">
  
    <span>Filed under: <a href="/tag/r/" title="r" rel="tag">r</a>, <a href="/tag/python/" title="python" rel="tag">python</a>, <a href="/tag/geocoding/" title="geocoding" rel="tag">geocoding</a></span>
  
</div><!-- /.page-meta -->
			</div><!-- /.page-title -->
      	</div><!-- /.page-image-media -->
		<div class="inner-wrap">
			<nav class="toc"></nav><!-- /.toc -->
			<div id="content" class="page-content" itemprop="articleBody">
				<p>The plot.</p>

<figure>
	<a href="/images/mappython_1_england.png"><img src="/images/mappython_1_england.png" /></a>
	<figcaption>My movements around the UK in the last two years (when I’ve had my phone on…).</figcaption>
</figure>

<p>Two github users<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> have put together two awesome scripts
 (I’ve merged the two and made some small edits at the bottom of the page). 
 One can convert json location data into kml data, and the other can plot kml over an image. 
 A few days after I posted this the first time, a fellow Jesuan did in R. I’d recommend using his 
 code<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup>, as it’s a lot easier to do it in R. </p>

<p>I find most of the learning comes from trying to add to the 
 scripts, rather than looking at how they work, which is why I am doing this in R. 
 Because the two scripts almost did 
 exactly what I wanted I didn’t really pick much up from doing this (although that also 
 meant it only took about 15 mins to make!).</p>

<p><a href="http://en.wikipedia.org/wiki/Google_Takeout">Google takeout</a> lets you take out all the data google holds you.
 That includes the location data it’s pulled on me from my phone 
 (I have the google now app installed). It’s very very patchy data, but in general shows 
 where I’ve been. The script, written by Snowdonjames, lets you also output csv’s, 
 which I’ll probably use in R.</p>

<p>The maps use the <em>PIL</em> library – which is a annoying to install. As I didn’t read the
 documentation for <em>PIL</em>, I had to re-install it a few times. Thankfully I used PIP, 
 so I was able to quickly uninstall it each time I realised PIL depended on something 
 I didn’t have installed (I also had to put a symlink in so PIL 
 could find the jpeg encoder).</p>

<p>You have to chuck in the image yourself (as R can pull from google maps, it will be even easier there).
 The England map is already in the <a href="https://github.com/snowdonjames/LatitudeHistoryPlotter">original repo</a>. For the other maps I used a site that looked American 
 Govermnent-y – but now I can’t find it. It lets you draw a square and gives the co-ordinates. 
 The actual google data is quite shoddy. Or rather, it only logs a position if I have the google 
 now app (or before 2012, the discontinued latitude app) open. So there are big gaps, often days 
 long, where there is no data at all. The script joins up each location with the last one, 
 which could be minutes or days ago. The script allows you to set a cut off, where it won’t 
 draw a line between two location points if the distance between them is too high. 
 Below I made a script to cycle through 5 to 100, then jumped up to 1000.</p>

<figure>
	<a href="/images/mappython_2_gif.gif"><img src="/images/mappython_2_gif.gif" /></a>
	<figcaption>A gif of different distance cut offs.</figcaption>
</figure>

<figure>
	<a href="/images/mappython_3_at70.png"><img src="/images/mappython_3_at70.png" /></a>
	<figcaption>My movements round Cam, with the cut off set to 70. It’s easy to spot home/college in the centre, a trip to Grantchester and the hospital/department south of Cam. Not sure why there is so much data from around the train station though, unless it’s because I pass to a new cell receiver (which is one of the prompts iOS uses to know if you’ve moved location without running the battery down by leaving the GPS on 24/7).</figcaption>
</figure>

<p>Below I’ve set the cut off very high (10,000), so those straight lines are flights.
  Outside of the UK I think this only shows airports, friends houses, or conferences 
  where I’ve use free wifi, as I don’t use mobile data abroad. Still pretty impressive 
  that, even if it’s not exact, google has a pretty good lock on where I am without me 
  actively telling them. And combined with having my gmail account, google drive, and my 
  search and browsing history they have a pretty impressive dataset on me.</p>

<figure>
	<a href="/images/mappython_4_europe.png"><img src="/images/mappython_4_europe.png" /></a>
	<figcaption>Travel around Europe – or rather trips I made that google’s servers have logged. This map also is a little offset, which I should of fixed with the nudge parameters – but I was trying to get this done in &lt;30 mins, as I know I can make it much prettier in R.</figcaption>
</figure>

<p>If you wanna fork/contribute to the original scripts by Snowdonjames and Scarygami,
 the one to format the data is here, and the one to make the plot is here.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#I&#39;ve merged code from two different sources, originally published by github users snowdonjames and Scarygami</span>
 
<span class="c">#Import JSON, spit out KML</span>
<span class="c">#usage.. location_history_json_converter.py input output [-h] [-f {kml,json,csv,js,gpx,gpxtracks}] [-v]</span>
 
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
 
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">argparse</span> <span class="kn">import</span> <span class="n">ArgumentParser</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
 
 
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">arg_parser</span> <span class="o">=</span> <span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">arg_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Input File (JSON)&quot;</span><span class="p">)</span>
    <span class="n">arg_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&quot;output&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Output File (will be overwritten!)&quot;</span><span class="p">)</span>
    <span class="n">arg_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--format&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;kml&quot;</span><span class="p">,</span> <span class="s">&quot;json&quot;</span><span class="p">,</span> <span class="s">&quot;csv&quot;</span><span class="p">,</span> <span class="s">&quot;js&quot;</span><span class="p">,</span> <span class="s">&quot;gpx&quot;</span><span class="p">,</span> <span class="s">&quot;gpxtracks&quot;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s">&quot;kml&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Format of the output&quot;</span><span class="p">)</span>
    <span class="n">arg_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">&quot;-v&quot;</span><span class="p">,</span> <span class="s">&quot;--variable&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&quot;locationJsonData&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Variable name to be used for js output&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">arg_parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">input</span> <span class="o">==</span> <span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
        <span class="n">arg_parser</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Input and output have to be different files&quot;</span><span class="p">)</span>
        <span class="k">return</span>
 
    <span class="k">try</span><span class="p">:</span>
        <span class="n">json_data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error opening input file&quot;</span><span class="p">)</span>
        <span class="k">return</span>
 
    <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error decoding json&quot;</span><span class="p">)</span>
        <span class="k">return</span>
 
    <span class="k">if</span> <span class="s">&quot;locations&quot;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;locations&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f_out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error creating output file for writing&quot;</span><span class="p">)</span>
            <span class="k">return</span>
 
        <span class="n">items</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;locations&quot;</span><span class="p">]</span>
 
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;json&quot;</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;js&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;js&quot;</span><span class="p">:</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;window.</span><span class="si">%s</span><span class="s"> = &quot;</span> <span class="o">%</span> <span class="n">args</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
 
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;{</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  </span><span class="se">\&quot;</span><span class="s">data</span><span class="se">\&quot;</span><span class="s">: {</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    </span><span class="se">\&quot;</span><span class="s">items</span><span class="se">\&quot;</span><span class="s">: [</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">first</span> <span class="o">=</span> <span class="bp">True</span>
 
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">first</span><span class="p">:</span>
                    <span class="n">first</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;,</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;      {</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;         </span><span class="se">\&quot;</span><span class="s">timestampMs</span><span class="se">\&quot;</span><span class="s">: </span><span class="si">%s</span><span class="s">,</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;timestampMs&quot;</span><span class="p">])</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;         </span><span class="se">\&quot;</span><span class="s">latitude</span><span class="se">\&quot;</span><span class="s">: </span><span class="si">%s</span><span class="s">,</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;latitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">))</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;         </span><span class="se">\&quot;</span><span class="s">longitude</span><span class="se">\&quot;</span><span class="s">: </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;longitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">))</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;      }&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">    ]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  }</span><span class="se">\n</span><span class="s">}&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;js&quot;</span><span class="p">:</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;;&quot;</span><span class="p">)</span>
 
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;csv&quot;</span><span class="p">:</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Time,Location</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;timestampMs&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S&quot;</span><span class="p">))</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;latitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;longitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">))</span>
 
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;kml&quot;</span><span class="p">:</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;&lt;?xml version=</span><span class="se">\&quot;</span><span class="s">1.0</span><span class="se">\&quot;</span><span class="s"> encoding=</span><span class="se">\&quot;</span><span class="s">UTF-8</span><span class="se">\&quot;</span><span class="s">?&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;&lt;kml xmlns=</span><span class="se">\&quot;</span><span class="s">http://www.opengis.net/kml/2.2</span><span class="se">\&quot;</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;Document&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;name&gt;Location History&lt;/name&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;Placemark&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="c"># Order of these tags is important to make valid KML: TimeStamp, ExtendedData, then Point</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;      &lt;TimeStamp&gt;&lt;when&gt;&quot;</span><span class="p">)</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;timestampMs&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Y-%m-</span><span class="si">%d</span><span class="s">T%H:%M:%SZ&quot;</span><span class="p">))</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;&lt;/when&gt;&lt;/TimeStamp&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s">&quot;accuracy&quot;</span> <span class="ow">in</span> <span class="n">item</span> <span class="ow">or</span> <span class="s">&quot;speed&quot;</span> <span class="ow">in</span> <span class="n">item</span> <span class="ow">or</span> <span class="s">&quot;altitude&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;      &lt;ExtendedData&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s">&quot;accuracy&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;Data name=</span><span class="se">\&quot;</span><span class="s">accuracy</span><span class="se">\&quot;</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;          &lt;value&gt;</span><span class="si">%d</span><span class="s">&lt;/value&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;accuracy&quot;</span><span class="p">])</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;/Data&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s">&quot;speed&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;Data name=</span><span class="se">\&quot;</span><span class="s">speed</span><span class="se">\&quot;</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;          &lt;value&gt;</span><span class="si">%d</span><span class="s">&lt;/value&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;speed&quot;</span><span class="p">])</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;/Data&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s">&quot;altitude&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;Data name=</span><span class="se">\&quot;</span><span class="s">altitude</span><span class="se">\&quot;</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;          &lt;value&gt;</span><span class="si">%d</span><span class="s">&lt;/value&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;altitude&quot;</span><span class="p">])</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;/Data&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;      &lt;/ExtendedData&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;      &lt;Point&gt;&lt;coordinates&gt;</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">&lt;/coordinates&gt;&lt;/Point&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;longitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;latitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">))</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;/Placemark&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;/Document&gt;</span><span class="se">\n</span><span class="s">&lt;/kml&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
 
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;gpx&quot;</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;gpxtracks&quot;</span><span class="p">:</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;&lt;?xml version=</span><span class="se">\&quot;</span><span class="s">1.0</span><span class="se">\&quot;</span><span class="s"> encoding=</span><span class="se">\&quot;</span><span class="s">UTF-8</span><span class="se">\&quot;</span><span class="s">?&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;&lt;gpx xmlns=</span><span class="se">\&quot;</span><span class="s">http://www.topografix.com/GPX/1/1</span><span class="se">\&quot;</span><span class="s"> version=</span><span class="se">\&quot;</span><span class="s">1.1</span><span class="se">\&quot;</span><span class="s"> creator=</span><span class="se">\&quot;</span><span class="s">Google Latitude JSON Converter</span><span class="se">\&quot;</span><span class="s"> xmlns:xsi=</span><span class="se">\&quot;</span><span class="s">http://www.w3.org/2001/XMLSchema-instance</span><span class="se">\&quot;</span><span class="s"> xsi:schemaLocation=</span><span class="se">\&quot;</span><span class="s">http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd</span><span class="se">\&quot;</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;metadata&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;name&gt;Location History&lt;/name&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;/metadata&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;gpx&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;wpt lat=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s"> lon=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">&quot;</span>  <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;latitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;longitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">))</span>
                    <span class="k">if</span> <span class="s">&quot;altitude&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;ele&gt;</span><span class="si">%d</span><span class="s">&lt;/ele&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;altitude&quot;</span><span class="p">])</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;time&gt;</span><span class="si">%s</span><span class="s">&lt;/time&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;timestampMs&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Y-%m-</span><span class="si">%d</span><span class="s">T%H:%M:%SZ&quot;</span><span class="p">)))</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;desc&gt;</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;timestampMs&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S&quot;</span><span class="p">))</span>
                    <span class="k">if</span> <span class="s">&quot;accuracy&quot;</span> <span class="ow">in</span> <span class="n">item</span> <span class="ow">or</span> <span class="s">&quot;speed&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot; (&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="s">&quot;accuracy&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Accuracy: </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;accuracy&quot;</span><span class="p">])</span>
                        <span class="k">if</span> <span class="s">&quot;accuracy&quot;</span> <span class="ow">in</span> <span class="n">item</span> <span class="ow">and</span> <span class="s">&quot;speed&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;, &quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="s">&quot;speed&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Speed:</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;speed&quot;</span><span class="p">])</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">)</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;&lt;/desc&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;/wpt&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s">&quot;gpxtracks&quot;</span><span class="p">:</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;trk&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;trkseg&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="n">lastloc</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="c"># The deltas below assume input is in reverse chronological order.  If it&#39;s not, uncomment this:</span>
                <span class="c"># items = sorted(data[&quot;data&quot;][&quot;items&quot;], key=lambda x: x[&#39;timestampMs&#39;], reverse=True)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">lastloc</span><span class="p">:</span>
                        <span class="n">timedelta</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&#39;timestampMs&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">lastloc</span><span class="p">[</span><span class="s">&#39;timestampMs&#39;</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">1000</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span>
                        <span class="n">distancedelta</span> <span class="o">=</span> <span class="n">getDistanceFromLatLonInKm</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&#39;latitudeE7&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;longitudeE7&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">,</span> <span class="n">lastloc</span><span class="p">[</span><span class="s">&#39;latitudeE7&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">,</span> <span class="n">lastloc</span><span class="p">[</span><span class="s">&#39;longitudeE7&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">timedelta</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">or</span> <span class="n">distancedelta</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">:</span>
                            <span class="c"># No points for 10 minutes or 40km in under 10m? Start a new track.</span>
                            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;/trkseg&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;/trk&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;trk&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;trkseg&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;      &lt;trkpt lat=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s"> lon=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;latitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;longitudeE7&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000000</span><span class="p">))</span>
                    <span class="k">if</span> <span class="s">&quot;altitude&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;ele&gt;</span><span class="si">%d</span><span class="s">&lt;/ele&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;altitude&quot;</span><span class="p">])</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;time&gt;</span><span class="si">%s</span><span class="s">&lt;/time&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">&quot;timestampMs&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Y-%m-</span><span class="si">%d</span><span class="s">T%H:%M:%SZ&quot;</span><span class="p">)))</span>
                    <span class="k">if</span> <span class="s">&quot;accuracy&quot;</span> <span class="ow">in</span> <span class="n">item</span> <span class="ow">or</span> <span class="s">&quot;speed&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;desc&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="s">&quot;accuracy&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;          Accuracy: </span><span class="si">%d</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;accuracy&quot;</span><span class="p">])</span>
                        <span class="k">if</span> <span class="s">&quot;speed&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;          Speed:</span><span class="si">%d</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">item</span><span class="p">[</span><span class="s">&quot;speed&quot;</span><span class="p">])</span>
                        <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;        &lt;/desc&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                    <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;      &lt;/trkpt&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                    <span class="n">lastloc</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;    &lt;/trkseg&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;  &lt;/trk&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">f_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;&lt;/gpx&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
 
        <span class="n">f_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
 
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;No data found in json&quot;</span><span class="p">)</span>
        <span class="k">return</span>
 
 
<span class="c"># Haversine formula</span>
<span class="k">def</span> <span class="nf">getDistanceFromLatLonInKm</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span><span class="n">lon1</span><span class="p">,</span><span class="n">lat2</span><span class="p">,</span><span class="n">lon2</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mi">6371</span> <span class="c"># Radius of the earth in km</span>
    <span class="n">dlat</span> <span class="o">=</span> <span class="n">deg2rad</span><span class="p">(</span><span class="n">lat2</span><span class="o">-</span><span class="n">lat1</span><span class="p">)</span>
    <span class="n">dlon</span> <span class="o">=</span> <span class="n">deg2rad</span><span class="p">(</span><span class="n">lon2</span><span class="o">-</span><span class="n">lon1</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlat</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlat</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat1</span><span class="p">))</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat2</span><span class="p">))</span> <span class="o">*</span> \
    <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlon</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dlon</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">))</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">c</span> <span class="c"># Distance in km</span>
    <span class="k">return</span> <span class="n">d</span>
 
 
<span class="k">def</span> <span class="nf">deg2rad</span><span class="p">(</span><span class="n">deg</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">deg</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
 
 
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">))</span>
 
<span class="c"># Load KML, picture and ImageData.csv and print picture</span>
<span class="c"># Need a csv with the following. Nudge is for correcting lat and long.</span>
<span class="c"># IMAGE.jpg,TOPOFBOXLAT, BOTTOMBOXLAT, LEFTBOXLONG, RIGHTBOXLONG,NUDGELAT,NUDGELONG</span>
 
 
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">mktime</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="kn">as</span> <span class="nn">ET</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span>
 
<span class="k">def</span> <span class="nf">GetKmlFiles</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Locates and reads local .kml files, returns a list of kml dictionary data&quot;&quot;&quot;</span> 
    <span class="n">KmlData</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
            <span class="k">if</span>  <span class="n">sp</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span> <span class="s">&quot;kml&quot;</span><span class="p">:</span> <span class="c">#locate kml files</span>
                <span class="k">print</span> <span class="s">&quot;Reading kml file &quot;</span> <span class="o">+</span> <span class="n">filename</span>
                <span class="n">KmlData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ReadKmlFile</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">KmlData</span>
 
<span class="k">def</span> <span class="nf">ReadKmlFile</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses a single kml file, returns a dict of format {time: [lat, long]}&quot;&quot;&quot;</span>
    <span class="n">KmlData</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">kmltime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">time</span>
    <span class="n">latlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">longlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">timelist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cnt</span> <span class="o">=</span><span class="mi">0</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">line</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">&#39;when&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">timelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span><span class="s">&quot;%Y-%m-</span><span class="si">%d</span><span class="s">T%H:%M:%SZ&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="s">&#39;coordinates&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">latlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">longlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">cnt</span> <span class="o">%</span> <span class="mi">5000</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;Parsing &quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s">&quot;: points found: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">latlist</span><span class="p">,</span> <span class="n">longlist</span><span class="p">,</span> <span class="n">timelist</span><span class="p">]</span>
 
<span class="k">def</span> <span class="nf">DrawMapData</span><span class="p">(</span><span class="n">KmlData</span><span class="p">,</span><span class="n">InputImage</span><span class="p">,</span> <span class="n">OutputImage</span><span class="p">,</span> <span class="n">itop</span><span class="p">,</span> <span class="n">ibottom</span><span class="p">,</span> <span class="n">ileft</span><span class="p">,</span> <span class="n">iright</span><span class="p">,</span><span class="n">xnudge</span><span class="p">,</span><span class="n">ynudge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws kml line data on top of the specified image&quot;&quot;&quot;</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">InputImage</span><span class="p">)</span>
    <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
    <span class="n">cnt</span> <span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">KmlD</span> <span class="ow">in</span> <span class="n">KmlData</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">KmlD</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="c">#Get points x and y coordinates and draw line</span>
            <span class="n">x1</span><span class="o">=</span><span class="p">(</span><span class="n">LongToX</span><span class="p">(</span><span class="n">KmlD</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">d</span><span class="p">],</span><span class="n">ileft</span><span class="p">,</span><span class="n">iright</span><span class="p">,</span><span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">+</span><span class="n">xnudge</span>
            <span class="n">y1</span><span class="o">=</span><span class="p">(</span><span class="n">LatToY</span><span class="p">(</span><span class="n">KmlD</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">d</span><span class="p">],</span><span class="n">itop</span><span class="p">,</span><span class="n">ibottom</span><span class="p">,</span><span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">+</span><span class="n">ynudge</span>
            <span class="n">x2</span><span class="o">=</span><span class="p">(</span><span class="n">LongToX</span><span class="p">(</span><span class="n">KmlD</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">ileft</span><span class="p">,</span><span class="n">iright</span><span class="p">,</span><span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">+</span><span class="n">xnudge</span>
            <span class="n">y2</span><span class="o">=</span><span class="p">(</span><span class="n">LatToY</span><span class="p">(</span><span class="n">KmlD</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">itop</span><span class="p">,</span><span class="n">ibottom</span><span class="p">,</span><span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">+</span><span class="n">ynudge</span>
            <span class="k">if</span><span class="p">(</span><span class="n">EuclidDistance</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">):</span>
                <span class="c">#setting this around 80 works okay. Attempts to remove some noise  </span>
                <span class="n">draw</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
            <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">cnt</span> <span class="o">%</span> <span class="mi">10000</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;Drawing point number &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
    <span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">OutputImage</span><span class="p">)</span>
        
<span class="k">def</span> <span class="nf">LongToX</span><span class="p">(</span><span class="n">InputLong</span><span class="p">,</span> <span class="n">LeftLong</span><span class="p">,</span> <span class="n">RightLong</span><span class="p">,</span> <span class="n">ImWidth</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a longitude value in to an x coordinate&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ScalingFunc</span><span class="p">(</span><span class="n">InputLong</span><span class="o">+</span><span class="mi">360</span><span class="p">,</span> <span class="n">LeftLong</span><span class="o">+</span><span class="mi">360</span><span class="p">,</span> <span class="n">RightLong</span><span class="o">+</span><span class="mi">360</span><span class="p">,</span> <span class="n">ImWidth</span><span class="p">);</span>
 
<span class="k">def</span> <span class="nf">LatToY</span><span class="p">(</span><span class="n">InputLat</span><span class="p">,</span> <span class="n">TopLat</span><span class="p">,</span> <span class="n">BottomLat</span><span class="p">,</span> <span class="n">ImHeight</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a latitude value in to a y coordinate&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ScalingFunc</span><span class="p">(</span><span class="n">InputLat</span><span class="o">+</span><span class="mi">360</span><span class="p">,</span> <span class="n">TopLat</span><span class="o">+</span><span class="mi">360</span><span class="p">,</span> <span class="n">BottomLat</span><span class="o">+</span><span class="mi">360</span><span class="p">,</span> <span class="n">ImHeight</span><span class="p">);</span>
 
<span class="k">def</span> <span class="nf">EuclidDistance</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the euclidean distance between two points&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
 
<span class="k">def</span> <span class="nf">ScalingFunc</span><span class="p">(</span><span class="n">inputv</span><span class="p">,</span> <span class="n">minv</span><span class="p">,</span> <span class="n">maxv</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helps convert latitudes and longitudes to x and y&quot;&quot;&quot;</span>
    <span class="k">if</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">maxv</span><span class="p">)</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">minv</span><span class="p">))</span> <span class="o">==</span><span class="mi">0</span><span class="p">):</span>
       <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="p">((((</span><span class="nb">float</span><span class="p">(</span><span class="n">inputv</span><span class="p">)</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">minv</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">maxv</span><span class="p">)</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">minv</span><span class="p">)))</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">size</span><span class="p">)));</span>
 
<span class="k">def</span> <span class="nf">ParseImageFile</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Reads SatelliteImageData.csv containing:</span>
<span class="sd">    &lt;File name of image to draw data on&gt;,</span>
<span class="sd">    &lt;image top latitude&gt;,</span>
<span class="sd">    &lt;image bottom lattitude&gt;,</span>
<span class="sd">    &lt;image left longitude&gt;,</span>
<span class="sd">    &lt;image right longitude&gt;,</span>
<span class="sd">    (optional) &lt;x value nudge&gt;,</span>
<span class="sd">    (optional) &lt;y value nudge&gt;&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;ImageData.csv&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">read_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="mi">5</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">read_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">read_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ReturnData</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span>
    <span class="n">ReturnData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">read_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">ReturnData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">read_data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ReturnData</span>
 
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">ImageData</span> <span class="o">=</span> <span class="n">ParseImageFile</span><span class="p">()</span>
    <span class="n">DrawMapData</span><span class="p">(</span><span class="n">GetKmlFiles</span><span class="p">(),</span><span class="n">ImageData</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;LatitudeData.png&quot;</span><span class="p">,</span> <span class="n">ImageData</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ImageData</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ImageData</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">ImageData</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">ImageData</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">ImageData</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span></code></pre></div>
<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p><a href="https://github.com/snowdonjames">Snowdonjames</a> and <a href="https://github.com/scarygami">Scarygami</a> <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>His blog is <a href="http://seasci.wordpress.com/2013/12/20/it-knows-where-i-live/">here</a>. <a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

				<hr />
				<footer class="page-footer">
					


<div class="author-image">
	<img src="http://epijim.uk/images/bio-photo.jpg" alt="James Black">
</div><!-- ./author-image -->
<div class="author-content">
	<h3 class="author-name" >Written by <a href="http://epijim.uk" itemprop="author">James Black</a></h3>
	<p class="author-bio">Reading Epidemiology at Jesus College, University of Cambridge.</p>
</div><!-- ./author-content -->
					<div class="inline-btn">
	<a class="btn-social twitter" href="https://twitter.com/intent/tweet?text=Mapping%20my%20google%20location%20data&amp;url=http://epijim.uk/blog/mapping-python/&amp;via=" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i> Share on Twitter</a>
	<a class="btn-social facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://epijim.uk/blog/mapping-python/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i> Share on Facebook</a>
	<a class="btn-social google-plus"  href="https://plus.google.com/share?url=http://epijim.uk/blog/mapping-python/" target="_blank"><i class="fa fa-google-plus" aria-hidden="true"></i> Share on Google+</a>
</div><!-- /.share-this -->
					<div class="page-meta">
	<p>Updated <time datetime="2013-12-19T00:00:00Z" itemprop="datePublished">December 19, 2013</time></p>
</div><!-- /.page-meta -->
				</footer><!-- /.footer -->
				<div class="entry-related">
					<h4>Related Articles <a href="#" onclick="(function(btn){var z=document.createElement('script');document.subtomeBtn=btn;z.src='https://www.subtome.com/load.js';document.body.appendChild(z);})(this);_gaq.push(['_trackEvent', 'Link', 'Subscribe']);" data-subtome-resource="http://epijim.uk" data-subtome-feeds="http://feeds.feedburner.com/epijim"><i class="fa fa-rss fa-fw"></i></a></h4>
					<ul>
						
						<li><a href="http://epijim.uk/blog/pub-distances/">Distance to the nearest pub</a></li>
						
						<li><a href="http://epijim.uk/code/googleapi/">Using Google API</a></li>
						
						<li><a href="http://epijim.uk/code/scrapexml/">Pulling an XML file off the internet</a></li>
						
						<li><a href="http://epijim.uk/blog/great-circles/">Facebook friend migrations</a></li>
						
					</ul>
				</div><!-- /.entry-related -->
				<aside>
				<hr />
<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'jamesblack';

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
				</aside>
			</div><!-- /.content -->
		</div><!-- /.inner-wrap -->
		
	</article><!-- /.wrap -->
</div><!-- /#main -->



      <footer role="contentinfo" id="site-footer">
	<nav role="navigation" class="menu bottom-menu">
		<ul class="menu-item">
		
      
        
      
			<li><a href="http://epijim.uk/" >Home</a></li>
		
      
        
      
			<li><a href="http://epijim.uk/my-papers/" >Papers</a></li>
		
      
        
      
			<li><a href="http://epijim.uk/about/" >About</a></li>
		
      
        
      
			<li><a href="http://epijim.uk/terms/" >Legal</a></li>
		
		</ul>
	</nav><!-- /.bottom-menu -->
	<p class="copyright">&#169; 2014 <a href="http://epijim.uk">James Black</a> hosted by <a href="https://pages.github.com">Github</a> and powered by <a href="http://jekyllrb.com">Jekyll</a> + <a href="http://mmistakes.github.io/skinny-bones-jekyll/">Skinny Bones</a>.</p>
<!-- google analytics -->	
<script> 
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47906301-1', 'auto');
  ga('send', 'pageview');

</script>
</footer>
    </div>

    <script src="http://epijim.uk/js/vendor/jquery-1.9.1.min.js"></script>
    <script src="http://epijim.uk/js/main.js"></script>
    
    

  </body>

</html>
