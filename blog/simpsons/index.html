<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Simpson's paradox in diabetes • James Black</title>
    <meta name="description" content="Using the D3 javascript library to visualise Simpson's paradox.">
    <meta name="keywords" content="Javascript, D3, Simpson's paradox">
    
    
    	<!-- Twitter Cards -->
	<meta name="twitter:title" content="Simpson's paradox in diabetes">
	<meta name="twitter:description" content="Using the D3 javascript library to visualise Simpson's paradox.">
	
	
	
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:image" content="http://epijim.uk/images/simpsons_feature.jpeg">
	
	<!-- Open Graph -->
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Simpson's paradox in diabetes">
	<meta property="og:description" content="Using the D3 javascript library to visualise Simpson's paradox.">
	<meta property="og:url" content="http://epijim.uk/blog/simpsons/">
	<meta property="og:site_name" content="James Black">
    <link rel="author" href="https://plus.google.com/https://plus.google.com/112022213613617220776/"/>

    <link rel="canonical" href="http://epijim.uk/blog/simpsons/">

    <link href="http://epijim.uk/atom.xml" type="application/atom+xml" rel="alternate" title="James Black Atom Feed">
    <link href="http://epijim.uk/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cleartype" content="on">

    <style>
    .sliding-menu-content {
      top: 0;
      right: 0;
      text-align: center;
      visibility: hidden;
      height: 100%;
      width: 100%;
      -webkit-transform: translateX(100%);
      -moz-transform: translateX(100%);
      -ms-transform: translateX(100%);
      -o-transform: translateX(100%);
      transform: translateX(100%);
    }
    </style>

    <link rel="stylesheet" href="http://epijim.uk/css/main.css">
    <!-- HTML5 Shiv and Media Query Support for IE -->
    <!--[if lt IE 9]>
      <script src="http://epijim.uk/js/vendor/html5shiv.min.js"></script>
      <script src="http://epijim.uk/js/vendor/respond.min.js"></script>
    <![endif]-->

  </head>

  <body>
    <header id="masthead">
  <div class="inner-wrap">
    <a href="http://epijim.uk" class="site-title">James Black</a>
    <nav role="navigation" class="menu top-menu">
        <ul class="menu-item">
	<li class="home"><a href="/">James Black</a></li>
	
    
        
    
    <li><a href="http://epijim.uk/my-papers/" >Papers</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/code/" >Code</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/blog/" >Blog</a></li>
  
    
        
    
    <li><a href="http://epijim.uk/about/" >About</a></li>
  
</ul>
    </nav>
  </div><!-- /.inner-wrap -->
</header><!-- /.masthead -->
    <nav role="navigation" class="js-menu sliding-menu-content">
	<ul class="menu-item">
		<li>
      
        
      
			<a href="http://epijim.uk/my-papers/"><img src="http://epijim.uk/images/papers_thumb.png" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/my-papers/" class="title">Papers</a>
			<p class="excerpt">My published journal articles.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/code/"><img src="http://epijim.uk/images/code_thumb.png" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/code/" class="title">Code</a>
			<p class="excerpt">A collection of code snippets I think are really useful.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/blog/"><img src="http://epijim.uk/images/blog_thumb.jpg" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/blog/" class="title">Blog</a>
			<p class="excerpt">My data based blog.</p>
		</li><li>
      
        
      
			<a href="http://epijim.uk/about/"><img src="http://epijim.uk/images/about_thumb.jpeg" alt="teaser" class="teaser"></a>
			<a href="http://epijim.uk/about/" class="title">About</a>
			<p class="excerpt">Get more information on, or contact, James Black.</p>
		</li>
	</ul>
</nav>
<button type="button" class="js-menu-trigger sliding-menu-button menulines-button x2" role="button" aria-label="Toggle Navigation">
	<span class="menulines"></span>
</button>

<div class="js-menu-screen menu-screen"></div>

    <div id="page-wrapper">
      <!--[if lt IE 9]><div class="upgrade notice-danger"><strong>Your browser is quite old!</strong> Why not <a href="http://whatbrowser.org/">upgrade to a newer one</a> to better enjoy this site?</div><![endif]-->

      <div id="main" role="main">	
	<article class="wrap" itemscope itemtype="http://schema.org/Article">
			<div class="page-feature-header overlay">
			
			<div class="page-image">
				<img src="http://epijim.uk/images/simpsons_feature.jpeg" class="page-feature-image" alt="Simpson's paradox in diabetes" itemprop="image">
				
			</div><!-- /.page-image -->
			
			<div class="page-title">
        	<h1><span>Simpson's paradox in diabetes</span></h1>
        	<div class="page-meta">
  
    <span>Filed under: <a href="/tag/javascript/" title="Javascript" rel="tag">Javascript</a>, <a href="/tag/d3/" title="D3" rel="tag">D3</a>, <a href="/tag/simpson-s-paradox/" title="Simpson's paradox" rel="tag">Simpson's paradox</a></span>
  
</div><!-- /.page-meta -->
			</div><!-- /.page-title -->
      	</div><!-- /.page-image-media -->
		<div class="inner-wrap">
			<nav class="toc"></nav><!-- /.toc -->
			<div id="content" class="page-content" itemprop="articleBody">
				<h2 id="definition">Definition</h2>

<p>For the month of July (2014) I’ll be teaching medical science for a summer school in my college.
 Over the last week I’ve started to put together the slides I’ll be using. To help explain 
 the concept of Simpson’s paradox I played around with rejigging somebody else’s code 
 to fit the context of diabetes (my research area). The code used to make 
 the plots below was originally written by the <a href="http://vudlab.com/simpsons/">Vudlab at UC Berkeley</a>.</p>

<p>I’ll let wikipedia give an introduction to the Simpson’s paradox,</p>

<blockquote>
  <p>Simpson’s paradox, or the Yule–Simpson effect, is a paradox in which a trend that appears in different groups of data disappears when these groups are combined, and the reverse trend appears for the aggregate data.</p>
</blockquote>

<h2 id="example">Example</h2>

<p>David Spiegelhalter, an academic who’s work I admire, contributed ideas
 to a paper on Simpson’s paradox that was published in the BMJ.<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> One of the examples used 
 in the paper was from the Poole diabetes cohort. The researchers broke a group of people with diabetes 
 into two groups. One required insulin (usually type 1 diabetes), the other sub-group didn’t (type 2 diabetes).</p>

<p>They followed the two groups, and found that those with insulin dependent diabetes were 31% <strong>less</strong>
 likely (95%CI 46% to 13%) to have died during the follow up. Yet when the adjusted for 
 age, the association flipped and those with insulin dependent diabetes were 15% <strong>more</strong> likely 
 to have died (<em>statistically non-significant</em>, 95%CI -9% to 46%).</p>

<h2 id="the-population">The population</h2>

<p>Below, each dot represents an individual from the study. Red have 
 insulin dependent diabetes. Blue have non-insulin dependent diabetes.</p>

<iframe width="650" height="260" src="http://epijim.uk/simpsons/all.html" frameborder="0"></iframe>

<h2 id="insulin-dependent-diabetes">Insulin dependent diabetes</h2>

<p>In the next plot is just the people with insulin dependent diabetes. In this group 29% of
 people died (those that died are the red dots). </p>

<iframe width="650" height="260" src="http://epijim.uk/simpsons/insulin.html" frameborder="0"></iframe>

<h2 id="non-insulin-dependent-diabetes">Non-insulin dependent diabetes</h2>

<p>And in the next plot is the people with non-insulin dependent diabetes. In this group 40% died
 during follow up. So it looks like people are more likely to die with non-insulin dependent 
 diabetes! This really doesn’t make sense, as insulin dependent diabetes is usually assumed 
 to be a more serious manifestation of the disease (insulin is a last resort in type 2 diabetes).</p>

<iframe width="650" height="260" src="http://epijim.uk/simpsons/noninsulin.html" frameborder="0"></iframe>

<h2 id="interactive-example">Interactive example</h2>

<p>The last plot below shows how the variable age helps explain what is happening. <em>Hitting the green
 button will make the individuals move between groups.</em> </p>

<p>This paradox occurs because people are more
 more likely to get type 2 diabetes later in life. People are also more likely to die later in 
 in life. So not accounting for the age difference in the people with the two conditions 
 means you can come to the wrong conclusions.</p>

<iframe width="650" height="500" src="http://epijim.uk/simpsons/index.html" frameborder="0"></iframe>

<p>I’m planning on including these plots in my slides (the joy of HTML5 slides is being able to
 to bring in amazing plot libraries like D3).</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>BMJ 1994;309:1480 <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

				<hr />
				<footer class="page-footer">
					


<div class="author-image">
	<img src="http://epijim.uk/images/bio-photo.jpg" alt="James Black">
</div><!-- ./author-image -->
<div class="author-content">
	<h3 class="author-name" >Written by <a href="http://epijim.uk" itemprop="author">James Black</a></h3>
	<p class="author-bio">Reading Epidemiology at Jesus College, University of Cambridge.</p>
</div><!-- ./author-content -->
					<div class="inline-btn">
	<a class="btn-social twitter" href="https://twitter.com/intent/tweet?text=Simpson&#39;s%20paradox%20in%20diabetes&amp;url=http://epijim.uk/blog/simpsons/&amp;via=" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i> Share on Twitter</a>
	<a class="btn-social facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://epijim.uk/blog/simpsons/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i> Share on Facebook</a>
	<a class="btn-social google-plus"  href="https://plus.google.com/share?url=http://epijim.uk/blog/simpsons/" target="_blank"><i class="fa fa-google-plus" aria-hidden="true"></i> Share on Google+</a>
</div><!-- /.share-this -->
					<div class="page-meta">
	<p>Updated <time datetime="2014-04-29T00:00:00Z" itemprop="datePublished">April 29, 2014</time></p>
</div><!-- /.page-meta -->
				</footer><!-- /.footer -->
				<div class="entry-related">
					<h4>Related Articles <a href="#" onclick="(function(btn){var z=document.createElement('script');document.subtomeBtn=btn;z.src='https://www.subtome.com/load.js';document.body.appendChild(z);})(this);_gaq.push(['_trackEvent', 'Link', 'Subscribe']);" data-subtome-resource="http://epijim.uk" data-subtome-feeds="http://feeds.feedburner.com/epijim"><i class="fa fa-rss fa-fw"></i></a></h4>
					<ul>
						
						<li><a href="http://epijim.uk/blog/great-circles/">Facebook friend migrations</a></li>
						
						<li><a href="http://epijim.uk/code/wes-anderson/">Wes Anderson palettes for R</a></li>
						
						<li><a href="http://epijim.uk/code/xkcd/">XKCD style graphs in R</a></li>
						
						<li><a href="http://epijim.uk/blog/independence/">Scottish independence polls</a></li>
						
					</ul>
				</div><!-- /.entry-related -->
				<aside>
				<hr />
<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'jamesblack';

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
				</aside>
			</div><!-- /.content -->
		</div><!-- /.inner-wrap -->
		
	</article><!-- /.wrap -->
</div><!-- /#main -->



      <footer role="contentinfo" id="site-footer">
	<nav role="navigation" class="menu bottom-menu">
		<ul class="menu-item">
		
      
        
      
			<li><a href="http://epijim.uk/" >Home</a></li>
		
      
        
      
			<li><a href="http://epijim.uk/my-papers/" >Papers</a></li>
		
      
        
      
			<li><a href="http://epijim.uk/about/" >About</a></li>
		
      
        
      
			<li><a href="http://epijim.uk/terms/" >Legal</a></li>
		
		</ul>
	</nav><!-- /.bottom-menu -->
	<p class="copyright">&#169; 2014 <a href="http://epijim.uk">James Black</a> hosted by <a href="https://pages.github.com">Github</a> and powered by <a href="http://jekyllrb.com">Jekyll</a> + <a href="http://mmistakes.github.io/skinny-bones-jekyll/">Skinny Bones</a>.</p>
<!-- google analytics -->	
<script> 
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-47906301-1', 'auto');
  ga('send', 'pageview');

</script>
</footer>
    </div>

    <script src="http://epijim.uk/js/vendor/jquery-1.9.1.min.js"></script>
    <script src="http://epijim.uk/js/main.js"></script>
    
    
    <script type="text/javascript">
      $('.toc').toc({
        'selectors': 'h2', //elements to use as headings
        'container': '.page-content', //element to find all selectors in
        'smoothScrolling': true, //enable or disable smooth scrolling on click
        'prefix': 'toc', //prefix for anchor tags and class names
        'onHighlight': function(el) {}, //called when a new section is highlighted 
        'highlightOnScroll': true, //add class to heading that is currently in focus
        'highlightOffset': 100, //offset to trigger the next headline
        'anchorName': function(i, heading, prefix) { //custom function for anchor name
          return prefix+i;
        },
        'headerText': function(i, heading, $heading) { //custom function building the header-item text
          return $heading.text();
        },
        'itemClass': function(i, heading, $heading, prefix) { //custom function for item class
          return $heading[0].tagName.toLowerCase();
        }
      });
    </script>
    

  </body>

</html>
