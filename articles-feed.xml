<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
	<title type="text">James Black &#8211; Articles</title>
	<subtitle type="html">Epidemiologist</subtitle>
	<generator uri="https://github.com/jekyll/jekyll">Jekyll</generator>
	<icon>http://epijim.co.uk/images/icon152.png</icon>
	<link rel="alternate" type="text/html" href="http://epijim.co.uk" />
	<updated>2014-03-13T22:04:01+00:00</updated>
	<id>http://epijim.co.uk/</id>
	<author>
		<name>James Black</name>
		<uri>http://epijim.co.uk/</uri>
		<email>james.black@cantab.net</email>
	</author>
	<rights>Unless otherwise noted, all content is published under a Creative Commons Attribution-Noncommercial-NoDerivs 3.0 United States License.</rights>
	<atom10:link xmlns:atom10="http://www.w3.org/2005/Atom" rel="self" type="application/atom+xml" href="http://epijim.co.uk/articles-feed.xml" />
	
	<entry>
		<title type="html"><![CDATA[3D scatter plot in R]]></title>
		<link rel="alternate" type="text/html" href="http://epijim.co.uk/articles/3Dscatter/" />
		<id>http://epijim.co.uk/articles/3Dscatter</id>
		<published>2014-03-10T00:00:00+00:00</published>
		<updated>2014-03-10T00:00:00+00:00</updated>
		<author>
			<name>James Black</name>
			<uri>http://epijim.co.uk</uri>
			<email>james.black@cantab.net</email>
		</author>
		<summary type="text">Easy way to plot a 3D scatter plot in R.</summary>
		<content type="html">&lt;h3 id=&quot;d-scatter-plot&quot;&gt;3D scatter plot&lt;/h3&gt;

&lt;p&gt;Just need &lt;em&gt;x&lt;/em&gt;, &lt;em&gt;y&lt;/em&gt; and &lt;em&gt;z&lt;/em&gt; in that order.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rgl&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

attach&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;plotdata&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	plot3d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;latitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; altitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; col&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
detach&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;plotdata&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On a mac, an XQuartz window will open up with the plot.&lt;/p&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/ski_scattergif.gif&quot;&gt;&lt;img src=&quot;/images/ski_scattergif.gif&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;

&lt;h3 id=&quot;d-density--contour-map&quot;&gt;3D density / contour map&lt;/h3&gt;

&lt;p&gt;And a density/contour plot. The data here is 2004 Tompkins scores for all the colleges
 at Cambridge against 2013 scores. As you can see, this graph isn’t that useful for looking 
 at &lt;em&gt;x&lt;/em&gt; vs. &lt;em&gt;y&lt;/em&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get the data&lt;/span&gt;
require&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;RCurl&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# this is due to an issue with https, R and github&lt;/span&gt;
data &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; getURL&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;https://gist.githubusercontent.com/epijim/8819934/raw/6c76df80eb095065a9ce0fa4b8f94410ad528fed/college_data.csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
data &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; read.csv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;text&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;data&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;stringsAsFactors&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k-Variable&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Required libraries&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rgl&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# plots it&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;MASS&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# derives the z axis&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Open graph&lt;/span&gt;
rgl.open&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;# Get the z axis&lt;/span&gt;
fit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; data&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Tompkin_1997&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Tompkin_2013&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
fit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; na.omit&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
fit &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; kde2d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;Tompkin_1997&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;Tompkin_2013&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot it&lt;/span&gt;
rgl.surface&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;m&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;z&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

par3d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;zoom &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Animate it&lt;/span&gt;
M &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; par3d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;userMatrix&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
play3d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;par3dinterp&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;userMatrix &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; list&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;M&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; rotate3d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;M&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; pi&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                                     rotate3d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;M&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; pi&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))),&lt;/span&gt; duration &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/ski_scattergif.gif&quot;&gt;&lt;img src=&quot;/images/scatter3d_scattergif2.gif&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;


		&lt;p&gt;&lt;a href=&quot;http://epijim.co.uk/articles/3Dscatter/&quot;&gt;3D scatter plot in R&lt;/a&gt; was originally published by &lt;a href=&quot;http://epijim.co.uk/about/&quot;&gt;James Black&lt;/a&gt; at &lt;a href=&quot;http://epijim.co.uk&quot;&gt;James Black&lt;/a&gt; on March 10, 2014.&lt;/p&gt;</content>
	</entry>
	
	<entry>
		<title type="html"><![CDATA[Plotting data from the ski tracks app in R]]></title>
		<link rel="alternate" type="text/html" href="http://epijim.co.uk/articles/ski-2014/" />
		<id>http://epijim.co.uk/articles/ski-2014</id>
		<published>2014-03-09T00:00:00+00:00</published>
		<updated>2014-03-09T00:00:00+00:00</updated>
		<author>
			<name>James Black</name>
			<uri>http://epijim.co.uk</uri>
			<email>james.black@cantab.net</email>
		</author>
		<summary type="text">Plotting data from the ski tracks app using R, from a recent trip to Pitztal Glacier.</summary>
		<content type="html">&lt;p&gt;A week ago Tina and I went skiing at an Austrian resort called Pitztal. While it’s a pretty small
 ski field by European standards&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;, Pitztal sits on the highest glacier in 
 Tyrol, and has incredible snow. Below is a map. We mainly skied on the Pitztal Glacier, and only really went across 
 to Rifflsee for the last few runs of the day. &lt;/p&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/ski_1_pitztal.jpg&quot;&gt;&lt;img src=&quot;/images/ski_1_pitztal.jpg&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;Map of the Pitztal Glacier ski field.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;While there I used an
 app called &lt;a href=&quot;https://itunes.apple.com/gb/app/ski-tracks-gps-track-recorder/id365724094?mt=8&quot;&gt;Ski Tracks&lt;/a&gt; 
 to record where, when and how fast I skied.&lt;/p&gt;

&lt;p&gt;The app actually makes really great graphics, and if you’re not an R fanatic there really isn’t
 a need to pull out the data and re-plot it yourself. Below are some example screens 
 from within the app.&lt;/p&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/ski_0_skitracksapp.png&quot;&gt;&lt;img src=&quot;/images/ski_0_skitracksapp.png&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;Five example screens from the app.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;get-the-data-into-r&quot;&gt;Get the data into R&lt;/h2&gt;

&lt;p&gt;I like the freedom to do what ever I want with the data though, so I pulled it into R.
 There are ready made functions out there to read a gpx file into a data frame&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;, or you 
 can use an online service to convert it to a csv.&lt;sup id=&quot;fnref:3&quot;&gt;&lt;a href=&quot;#fn:3&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;h2 id=&quot;define-run-direction&quot;&gt;Define run direction&lt;/h2&gt;

&lt;p&gt;As you ski down the hill, and ride a gondola up it, it should be easy to code if you are
 actually skiing.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# code if going up or down!&lt;/span&gt;
  updown &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sapply&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;nrow&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;routes
                                 &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                          &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                            ifelse&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;routes&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;elevation&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; routes&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;elevation&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Up&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Down&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Unfortunately you do go up and down during a run, so I had to do some manual edits after.&lt;/p&gt;

&lt;h2 id=&quot;day-one-skiing&quot;&gt;Day one skiing&lt;/h2&gt;

&lt;p&gt;Below is day one of skiing. The code for this plot &lt;a href=&quot;http://www.epijim.co.uk/articles/pathsinr/&quot;&gt;is here&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
	&lt;img src=&quot;/images/ski_1_sat.png&quot; /&gt;
	&lt;img src=&quot;/images/ski_2_ter.png&quot; /&gt;
	&lt;figcaption&gt;Our first day skiing. On the left the basemap is a satellite photo, on the right it&#39;s a terrain map. Lifts are in red, runs in blue.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;day-one-two-and-three-skiing&quot;&gt;Day one, two and three skiing&lt;/h2&gt;

&lt;p&gt;At Pitztal, you take an underground train from the village up to the glacier. On the second day 
 we found out it is possible to ski down from the Glacier, all the way through the town, 
 to the gondola that goes up to the other part of the ski field called Rifflsee. This was 
 my favourite run on the mountain, as the one run was a vertical drop from 3,440m to 1,674m.&lt;sup id=&quot;fnref:4&quot;&gt;&lt;a href=&quot;#fn:4&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt; Meaning you start 
 a couple of hundred metres below the height of Mt Cook (NZ’s biggest mountain), and ski a vertical 
 distance that’s bigger than the distance between the top of Coronet Peak ski field, and sea level.&lt;/p&gt;

&lt;p&gt;The best bit of the run that goes between the ski areas was you have to ski through the gate
 below at the start of the trail.&lt;/p&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/ski_gif.gif&quot;&gt;&lt;img src=&quot;/images/ski_gif.gif&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;

&lt;p&gt;The photo’s below show day one and three overlaid. The blue line linking the two ski fields
 is the epic run mentioned above. &lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
	&lt;img src=&quot;/images/ski_4a_1n2_ter.png&quot; /&gt;
	&lt;img src=&quot;/images/ski_4b_1n2_sat.png&quot; /&gt;
	&lt;figcaption&gt;First and third day skiing on the same plots. Day one is a lighter blue.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;According to &lt;em&gt;Ski Tracks&lt;/em&gt;, my top speed was over 110 km/hr. Looking at the raw data, there was one
 part of the run where I was at mid-80’s, before suddenly it jumped up 20 km/hr for 3 data points (&lt;em&gt;which was about a second&lt;/em&gt;). 
 This is just phone GPS data, and probably full of errors, so I manually subtracted the bonus 20 from those three data points.&lt;/p&gt;

&lt;p&gt;In general the &lt;em&gt;Ski Tracks&lt;/em&gt; app seems to do some sneaky smoothing when it plots the data in-app.
 The raw data seems to have bigger variations. For one sequence of three data points, my phone claims I went 
 from 76 km/hr to 85 km/hr to 71 km/hr. In just under a second. Because of this, coupled with the implausible 120 km/hr 
 speed burst, I decided I should chuck a rolling average over my speed data.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;map_data_2_trunc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; map_data_2&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  map_data_2&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;index &lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt; names&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;which&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;table&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;map_data_2&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;index&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; 
  &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# make a subset of data with just runs over 10 data points (i.e. at least a minute long).&lt;/span&gt;

library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;zoo&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# zoo has the rollmean function&lt;/span&gt;
index &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; unique&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;map_data_2_trunc&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;index&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# only do rolling average within a run&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; index&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  map_data_2_trunc&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; 
    which&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;map_data_2_trunc&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;index&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;speed_roll&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rollmean&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;map_data_2_trunc&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; 
    which&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;map_data_2_trunc&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;index&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;speed&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Average over 5 points. Note, as at the start of a run you cant&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#				 have a rolling average, so some data points are lost, &lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#                and become NA.&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now plotting the runs, colouring by the rolling average speed.&lt;/p&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/ski_5_time.png&quot;&gt;&lt;img src=&quot;/images/ski_5_time.png&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;Start and end altitudes of runs on the second day.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;The data seemed to be the most unreliable for a handful of the runs. In the next dotplot I
 tightened up the code to drop any runs with less than 100 data points, and increased the rolling 
 average to to cover about a 30 seconds of data. I liked how the bits of the run where I 
 usually slow down start to show up.&lt;/p&gt;

&lt;p&gt;Code for the dotplot is &lt;a href=&quot;http://epijim.co.uk/articles/dotplot/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/ski_6_runs.png&quot;&gt;&lt;img src=&quot;/images/ski_6_runs.png&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;A dotplot of rolling average speed accross a selected sub sample of runs on the second day.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Finally, a 3D scatter plot of the runs from day two. The 3D scatter plot is super simple to make: 
code &lt;a href=&quot;http://epijim.co.uk/articles/3Dscatter/&quot;&gt;is here&lt;/a&gt;.&lt;/p&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/ski_scattergif.gif&quot;&gt;&lt;img src=&quot;/images/ski_scattergif.gif&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Pitztal has 40.6 km of runs accross Rifflsee and the Glacier. Arlberg, Kaprun, SkiWelt and Ischgil are all Austrian ski fields with more than 220km of piste. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:2&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;http://plotkml.r-forge.r-project.org/readGPX.html&quot;&gt;readGPX&lt;/a&gt; is an example from CRAN. &lt;a href=&quot;#fnref:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:3&quot;&gt;
      &lt;p&gt;An example of a free service is &lt;a href=&quot;http://www.gpsvisualizer.com/convert_input&quot;&gt;GPS visualiser&lt;/a&gt; &lt;a href=&quot;#fnref:3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:4&quot;&gt;
      &lt;p&gt;If you started at the top of the highest gondola at Pitztal. &lt;a href=&quot;#fnref:4&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;

		&lt;p&gt;&lt;a href=&quot;http://epijim.co.uk/articles/ski-2014/&quot;&gt;Plotting data from the ski tracks app in R&lt;/a&gt; was originally published by &lt;a href=&quot;http://epijim.co.uk/about/&quot;&gt;James Black&lt;/a&gt; at &lt;a href=&quot;http://epijim.co.uk&quot;&gt;James Black&lt;/a&gt; on March 09, 2014.&lt;/p&gt;</content>
	</entry>
	
	<entry>
		<title type="html"><![CDATA[Plotting paths in R]]></title>
		<link rel="alternate" type="text/html" href="http://epijim.co.uk/articles/pathsinr/" />
		<id>http://epijim.co.uk/articles/pathsinr</id>
		<published>2014-03-09T00:00:00+00:00</published>
		<updated>2014-03-09T00:00:00+00:00</updated>
		<author>
			<name>James Black</name>
			<uri>http://epijim.co.uk</uri>
			<email>james.black@cantab.net</email>
		</author>
		<summary type="text">Plotting GPS points over a path in R.</summary>
		<content type="html">&lt;h3 id=&quot;get-the-base-map-from-google&quot;&gt;Get the base map from google&lt;/h3&gt;

&lt;p&gt;In the plots below I use the &lt;em&gt;satellite&lt;/em&gt; and &lt;em&gt;terrain&lt;/em&gt; options of &lt;em&gt;maptype&lt;/em&gt;. The &lt;em&gt;day1&lt;/em&gt; object
 is the centre of the map I want. &lt;em&gt;Zoom&lt;/em&gt; controls the&lt;em&gt;..well..&lt;/em&gt;zoom.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggmap&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
day1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;lon&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10.874062&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          lat&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;46.918028&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# longitude of centre&lt;/span&gt;

basemap &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; get_map&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;location&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;day1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     zoom&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     source&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;google&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     maptype&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;satellite&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     &lt;span class=&quot;c1&quot;&gt;#color=&amp;quot;bw&amp;quot;&lt;/span&gt;
                     &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;plot-ski-run-paths&quot;&gt;Plot ski run paths&lt;/h3&gt;

&lt;p&gt;The code below plots individual paths using the index, &lt;em&gt;run_number&lt;/em&gt;. So that the &lt;em&gt;ups&lt;/em&gt;, and
 &lt;em&gt;downs&lt;/em&gt;, are a different colour, I cut the data using &lt;em&gt;which&lt;/em&gt;. Usually I could just chuck 
 up or down into colour, but this makes it easy to just plot runs down.  &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;ggmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;basemap&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    geom_path&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;latitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                 group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;run_number&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                             size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                             color&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;#0000FF4D&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                             alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                             data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;map_data&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; 
                               which&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;map_data&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;up&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;down&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                               &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    geom_path&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;latitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                  group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;run_number&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                              size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                              color&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;#FF00004D&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                              alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                              data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;map_data&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; 
                                which&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;map_data&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;up&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;up&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                                &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And the plots! &lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
	&lt;img src=&quot;/images/ski_1_sat.png&quot; /&gt;
	&lt;img src=&quot;/images/ski_2_ter.png&quot; /&gt;
	&lt;figcaption&gt;Our first day skiing. On the left is the basemap is a satellite photo, on the right it&#39;s a terrain map.&lt;/figcaption&gt;
&lt;/figure&gt;


		&lt;p&gt;&lt;a href=&quot;http://epijim.co.uk/articles/pathsinr/&quot;&gt;Plotting paths in R&lt;/a&gt; was originally published by &lt;a href=&quot;http://epijim.co.uk/about/&quot;&gt;James Black&lt;/a&gt; at &lt;a href=&quot;http://epijim.co.uk&quot;&gt;James Black&lt;/a&gt; on March 09, 2014.&lt;/p&gt;</content>
	</entry>
	
	<entry>
		<title type="html"><![CDATA[Making a dotplot in R]]></title>
		<link rel="alternate" type="text/html" href="http://epijim.co.uk/articles/dotplot/" />
		<id>http://epijim.co.uk/articles/dotplot</id>
		<published>2014-03-09T00:00:00+00:00</published>
		<updated>2014-03-09T00:00:00+00:00</updated>
		<author>
			<name>James Black</name>
			<uri>http://epijim.co.uk</uri>
			<email>james.black@cantab.net</email>
		</author>
		<summary type="text">How to make a dotplot using ggplot in R.</summary>
		<content type="html">&lt;p&gt;Dot plots have a continuos variable, plotted against a factor. Usually with form of jitter and
 transparency to make the frequency stand out. Almost like an impressionist box plot.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;plotdata&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; altitude..m.&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; as.factor&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;index&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; speed&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; position_jitter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;w &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; h &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  scale_colour_gradient&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;low&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; high&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/ski_6_runs.png&quot;&gt;&lt;img src=&quot;/images/ski_6_runs.png&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;


		&lt;p&gt;&lt;a href=&quot;http://epijim.co.uk/articles/dotplot/&quot;&gt;Making a dotplot in R&lt;/a&gt; was originally published by &lt;a href=&quot;http://epijim.co.uk/about/&quot;&gt;James Black&lt;/a&gt; at &lt;a href=&quot;http://epijim.co.uk&quot;&gt;James Black&lt;/a&gt; on March 09, 2014.&lt;/p&gt;</content>
	</entry>
	
	<entry>
		<title type="html"><![CDATA[Restaurant hygiene ratings in Cambridge]]></title>
		<link rel="alternate" type="text/html" href="http://epijim.co.uk/articles/restaurant-hygiene/" />
		<id>http://epijim.co.uk/articles/restaurant-hygiene</id>
		<published>2014-02-19T00:00:00+00:00</published>
		<updated>2014-02-19T00:00:00+00:00</updated>
		<author>
			<name>James Black</name>
			<uri>http://epijim.co.uk</uri>
			<email>james.black@cantab.net</email>
		</author>
		<summary type="text">Plotting Cambridge restaurant cleanliness using R.</summary>
		<content type="html">&lt;figure&gt;
	&lt;a href=&quot;/images/hygiene_1.png&quot;&gt;&lt;img src=&quot;/images/hygiene_1.png&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;The dirtiest restaurants in Cambridge (Hygiene rating of 1), on the 20th Feb 2014.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Above is a plot of the restaurants in Cambridge that have a food safety rating of one.
 I’ve manually moved the labels so none overlap, which means the locations are 
 approximate. This plot is the last one from the analysis below.&lt;/p&gt;

&lt;p&gt;This plot was made after a friend pointed out the Food Standards Agency publishes their data, 
 so anyone can go to their &lt;a href=&quot;http://ratings.food.gov.uk/open-data/en-GB&quot;&gt;open data site&lt;/a&gt; and 
 download away. So, after downloading the file, I copied it across to a csv (it comes as xml). &lt;/p&gt;

&lt;p&gt;Then, I load up the packages and the data file I’ll be using.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;require&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
require&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggmap&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
require&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;devtools&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;RColorBrewer&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# scale colours&lt;/span&gt;

setwd&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;folder to output to&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

cam_restaurants &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; read.csv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;cam_restaurants.csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# load data &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now places like newsagents that sell food also get rated, so I’m going to subset out just the
 the kinda joints I’m really interested in.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;  selected&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Mobile caterer&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;s&quot;&gt;&amp;quot;Pub/bar/nightclub&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;s&quot;&gt;&amp;quot;Restaurant/Cafe/Canteen&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;s&quot;&gt;&amp;quot;Takeaway/sandwich shop&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  cam_clip &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; cam_restaurants&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;cam_restaurants&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;BusinessType &lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt; selected&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I’ll also need to get three maps of Cambridge at different magnifications.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;cam &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; get_map&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Cambridge, UK&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;scale&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; color&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bw&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
cam_mid &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; get_map&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Cambridge, UK&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;scale&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; color&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bw&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
cam_zoom &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; get_map&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Cambridge, UK&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;scale&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; color&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bw&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And the first plot - where the food selling places are, and which of the four categories they are.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;pdf&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;cam_4.pdf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
ggmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cam_clip&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Latitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                            colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;BusinessType&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                        size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        shape&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
dev.off&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/hygiene_1.png&quot;&gt;&lt;img src=&quot;/images/hygiene_2.png&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;Food outlets in Cambridge, by outlet type.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;What about the food ratings? First I’ll split it into 1 &amp;amp; 2 (which is bad) and 3-5 (which are
 the ones rated the highest).&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;cam_cut &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; cam_clip
  levels&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam_cut&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;RatingValue&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  combine1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    levels&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam_cut&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;RatingValue&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;levels&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam_cut&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;RatingValue&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt; combine1&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; paste&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;abbreviate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;combine1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; collapse &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;amp;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  combine2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;3&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;4&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;5&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Exempt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    levels&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam_cut&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;RatingValue&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;levels&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam_cut&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;RatingValue&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt; combine2&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; paste&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;abbreviate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;combine2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; collapse &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;amp;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And now I plot the dirty (1-2) against the clean (3-5 and exempt). If you run this code, you’ll
 see the &lt;em&gt;extant&lt;/em&gt; options makes sure my contour plot isn’t constrained. Which also meant I had
 to edit this plot down after running it.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;pdf&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;cam_dirty_points.pdf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
ggmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam_mid&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; extent &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;normal&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; maprange&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_density2d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; cam_clip_dirty&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                 aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Latitude&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  stat_density2d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; cam_clip_dirty&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                 aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Latitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ..level..&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; alpha &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ..level..&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                 size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; bins &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; geom &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;polygon&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cam_clip_dirty&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Latitude&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
             size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             color&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             shape&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
dev.off&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

pdf&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;cam_clean_points.pdf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
ggmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam_mid&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; extent &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;normal&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; maprange&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_density2d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; cam_clip_clean&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                 aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Latitude&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  stat_density2d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; cam_clip_clean&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                 aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Latitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ..level..&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; alpha &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ..level..&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                 size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; bins &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; geom &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;polygon&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cam_clip_clean&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Latitude&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
             color&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             shape&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
dev.off&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/hygiene_3.png&quot;&gt;&lt;img src=&quot;/images/hygiene_3.png&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;Location of restaurants with good and bad food safety ratings.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;And a gif going from 1 (bad) to 5 (great). No code, as gifs from R requires installing external
 programs via the terminal. This makes it more clear that it’s not just &lt;em&gt;‘the dodgy places are in Mill Rd’&lt;/em&gt;,
  as the 4 star rated places are also clustered towards Mill Rd. It’s mainly just 
  but it looks like the very worst rated places are out towards Mill Rd, while the 5 star 
  rated places are clustered back towards the centre.&lt;/p&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/hygiene_4a.gif&quot;&gt;&lt;img src=&quot;/images/hygiene_4a.gif&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;Looped gif across ratings 1-5.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;So most of the restaurants with poor food safety ratings are around mill road. So what are the called?&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;
 The following code will plot their names, zooming in on Mill Road. I manually moved the labels around 
 to make them readable. So it’s just the rough location.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;cam_clip_dirty_1&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;Business &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; as.character&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam_clip_dirty_1&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;BusinessName&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# change format for plotting&lt;/span&gt;
cam_clip_dirty_1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; cam_clip&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;cam_clip&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;RatingValue &lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# clip to dirty&lt;/span&gt;
cam_mill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; get_map&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Mill Rd, Cambridge, UK&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;scale&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; color&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bw&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# focus on mill road&lt;/span&gt;
p &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cam_mill&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
p &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; p &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; xlab&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Longitude&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;ylab&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Latitude&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
p &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; p &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; cam_clip_dirty_1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                   aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Longitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                       y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Latitude&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                       label &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Business&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       color&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Business
                       &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                   size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; vjust &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; hjust &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
p
ggsave&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;dodgey_name.pdf&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;figure&gt;
	&lt;a href=&quot;/images/hygiene_1.png&quot;&gt;&lt;img src=&quot;/images/hygiene_1.png&quot; /&gt;&lt;/a&gt;
	&lt;figcaption&gt;The dirtiest restaurants in Cambridge (Hygiene rating of 1), on the 20 Feb 2014.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;I should add this was their status on the 20th of Feb 2014, they may of redeemed themselves since! I know a favourite curry house of many Jesuans, was also responsible for a major food poisoning outbreak. So these poor ratings are hopefully transient. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;

		&lt;p&gt;&lt;a href=&quot;http://epijim.co.uk/articles/restaurant-hygiene/&quot;&gt;Restaurant hygiene ratings in Cambridge&lt;/a&gt; was originally published by &lt;a href=&quot;http://epijim.co.uk/about/&quot;&gt;James Black&lt;/a&gt; at &lt;a href=&quot;http://epijim.co.uk&quot;&gt;James Black&lt;/a&gt; on February 19, 2014.&lt;/p&gt;</content>
	</entry>
	
</feed>