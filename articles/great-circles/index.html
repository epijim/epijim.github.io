<!doctype html> <!--[if lt IE 7]><html class="lt-ie9 lt-ie8 lt-ie7 no-js" lang="en"><![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="lt-ie9 lt-ie8 no-js" lang="en"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="lt-ie9 no-js" lang="en"><![endif]--> <!--[if gt IE 8]><!--> <html lang="en" class="no-js"><!--<![endif]--> <head> <meta charset="utf-8"> <title>Facebook friend migrations &#8211; James Black</title> <meta name="description" content="Facebook friend migrations (great circles and geocoding in R)."> <meta name="keywords" content="R, Great circles"> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://0.0.0.0:4000/images/greatcircles_thumb.png"> <meta name="twitter:title" content="Facebook friend migrations"> <meta name="twitter:description" content="Facebook friend migrations (great circles and geocoding in R)."> <meta name="twitter:site" content="@"> <meta name="twitter:creator" content="@"> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Facebook friend migrations"> <meta property="og:description" content="Facebook friend migrations (great circles and geocoding in R)."> <meta property="og:url" content="http://0.0.0.0:4000/articles/great-circles/"> <meta property="og:site_name" content="James Black"> <link rel="canonical" href="http://0.0.0.0:4000/articles/great-circles/"> <link href="http://feeds.feedburner.com/epijim" type="application/atom+xml" rel="alternate" title="James Black &#8211; Everything Feed"> <link rel="author" href="https://plus.google.com/112022213613617220776/?rel=author"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta http-equiv="cleartype" content="on"> <link rel="stylesheet" href="http://0.0.0.0:4000/css/main.min-b18f500fc8710c1f7acf8c04b0249d6f.css"> <script src="//use.edgefonts.net/lato:n3,i3,n4,i4,n7.js"></script> <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"> <!--[if lt IE 9]><script src="http://0.0.0.0:4000/js/vendor/html5shiv-5a98a86b5cb48c1506f338463259ce41.js"></script> <script src="http://0.0.0.0:4000/js/vendor/respond-e5d7fffb3a9f891c926ee1b836d448d8.js"></script><![endif]--> <link rel="shortcut icon" href="http://0.0.0.0:4000/favicon.ico"> <link rel="shortcut icon" href="http://0.0.0.0:4000/favicon.png"> <link rel="apple-touch-icon-precomposed" href="http://0.0.0.0:4000/images/icon57.png" sizes="57x57"> <link rel="apple-touch-icon-precomposed" href="http://0.0.0.0:4000/images/icon72.png" sizes="72x72"> <link rel="apple-touch-icon" href="http://0.0.0.0:4000/images/icon76.png" sizes="76x76"> <link rel="apple-touch-icon-precomposed" href="http://0.0.0.0:4000/images/icon114.png" sizes="114x114"> <link rel="apple-touch-icon" href="http://0.0.0.0:4000/images/icon120.png" sizes="120x120"> <link rel="apple-touch-icon-precomposed" href="http://0.0.0.0:4000/images/icon144.png" sizes="144x144"> <link rel="apple-touch-icon" href="http://0.0.0.0:4000/images/icon152.png" sizes="152x152"> <script>(function(m,l,g,i,k,n,a){m.GoogleAnalyticsObject=k;m[k]=m[k]||function(){(m[k].q=m[k].q||[]).push(arguments)},m[k].l=1*new Date();n=l.createElement(g),a=l.getElementsByTagName(g)[0];n.async=1;n.src=i;a.parentNode.insertBefore(n,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-47906301-1","epijim.co.uk");ga("send","pageview");</script> </head> <body id="post"> <!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a newer one to better enjoy this site?</a></div><![endif]--> <div class="masthead-wrapper"> <header id="masthead" itemscope itemtype="http://schema.org/Organization"> <a href="http://0.0.0.0:4000" class="site-logo" rel="home" title="James Black" itemprop="url"><img src="http://0.0.0.0:4000/images/jimmy_logo.png" width="50" height="50" alt="James Black logo" itemprop="logo"></a> <span class="site-title" itemprop="name"><a href="http://0.0.0.0:4000">James Black</a></span> </header> <nav role="navigation" id="site-nav" class="nav"> <ul> <li itemscope itemtype="http://schema.org/SiteNavigationElement"><a href="http://0.0.0.0:4000/" itemprop="url"><span itemprop="name">Home</span></a></li> <li itemscope itemtype="http://schema.org/SiteNavigationElement"><a href="http://0.0.0.0:4000/blog/" itemprop="url"><span itemprop="name">Blog</span></a></li> <li itemscope itemtype="http://schema.org/SiteNavigationElement"><a href="http://0.0.0.0:4000/plots/" itemprop="url"><span itemprop="name">Gallery</span></a></li> <li itemscope itemtype="http://schema.org/SiteNavigationElement"><a href="http://0.0.0.0:4000/my-papers/" itemprop="url"><span itemprop="name">My papers</span></a></li> <li itemscope itemtype="http://schema.org/SiteNavigationElement"><a href="http://0.0.0.0:4000/about/" itemprop="url"><span itemprop="name">About me</span></a></li> </ul> </nav> </div> <div id="main" role="main"> <article class="hentry" itemscope itemtype="http://schema.org/Article"> <header class="entry-header"> <h1 class="entry-title" itemprop="name">Facebook friend migrations</h1> </header> <div class="entry-wrapper"> <div class="entry-content" itemprop="articleBody"> <figure> <a href="/images/greatcircles_1_final.png"><img src="/images/greatcircles_1_final.png"/></a> <figcaption>Great circles plot of my facebook friend's migrations.</figcaption> </figure> <p>Facebook users are asked to fill in their hometown, and where they live now (although only about 60%ish of my friends actually filled this data in). This data is all up for grabs using the Facebook API, as I detailed in an earlier post. In the plot above, the blue dot is my Facebook friends hometown and the red is where they live now. I have put a black line connecting hometown to current location.</p> <p>Unfortunately this map only highlights outliers – the vast majority of my friends are clustered in a few cities. I played around a bit with the transparency of the points and lines to try and get a sense of numbers involved, but this graph still doesn’t convey the fact that a big portion of my friends currently live in Cambridge, and their hometown was London, Wellington or Auckland.</p> <p>The lines connecting hometown to current location are drawn as ‘great circles’, using the geosphere package. The site Flowing data gives a good tutorial on how to use the package. One thing it doesn’t help with though, is what to do when a connecting line crosses the international dateline. The problem is that the command spits out a matrix giving the path between two points, but if someone crosses the date line it spits out a list of two matrices. One matrix for each side of the datelie. That’s why I added the messy IF statements to the code below.</p> <p>The plot above also suggests the fastest way between London and New Zealand is by skirting the North Pole. This surprised me – so in case you don’t believe the plot above, the picture below is a screenshot of the shortest distance between Auckland and London, according to the website Maptools.</p> <figure> <a href="/images/greatcircles_2_profile.png"><img src="/images/greatcircles_2_profile.png"/></a> <figcaption>Screenshot of a great circle according to www.freemaptools.com.</figcaption> </figure> <p>Here’s the plot again without the lines. I think my next plan is to find a way to plot the latitude and longitudes into a country level chloropleth. I played around with hexbinning, but the data is too clumped for that style of plot.</p> <figure> <a href="/images/greatcircles_3_point.png"><img src="/images/greatcircles_3_point.png"/></a> <figcaption>First plot, without the great circle lines.</figcaption> </figure> <p>I was pretty surprised by the spread of my friends migrations. A lot more than I thought were still within a few thousand KMs of their hometown. As not all my friends filled in the hometown and current location fields in Facebook, I’m assuming there is a bias where the friends that migrate are also less likely to share their data on Facebook.</p> <figure> <a href="/images/greatcircles_4_hist.png"><img src="/images/greatcircles_4_hist.png"/></a> <figcaption>Histograph of the distance my FB friends are from home.</figcaption> </figure> <p>With the caveat that the data has holes, and as it is just my Facebook friends is completely unrepresentative, the plot below (raw data points in red over a box plot) separates my friends into those with a hometown in NZ, and those with a hometown anywhere else. You can see the clusters of Kiwis that have moved to Melbourne, and the cluster in Europe.</p> <figure> <a href="/images/greatcircles_5_swarm.png"><img src="/images/greatcircles_5_swarm.png"/></a> <figcaption>Swarm plot comparing Kiwi's to other friends.</figcaption> </figure> <p>This last plot is zoomed into New Zealand.</p> <figure> <a href="/images/greatcircles_6_NZ.png"><img src="/images/greatcircles_6_NZ.png"/></a> <figcaption>Zoomed into NZ. Once again, hometown is in blue, location now in red.</figcaption> </figure> <div class="entry-related"> <h2>Related Articles <a href="#" onclick="(function(btn){var z=document.createElement('script');document.subtomeBtn=btn;z.src='https://www.subtome.com/load.js';document.body.appendChild(z);})(this);_gaq.push(['_trackEvent', 'Link', 'Subscribe']);" data-subtome-resource="http://0.0.0.0:4000" data-subtome-feeds="http://feeds.feedburner.com/epijim"><i class="fa fa-rss fa-fw"></i></a></h2> <ul> <li><a href="http://0.0.0.0:4000/articles/3Dscatter/">3D scatter plot in R</a></li> <li><a href="http://0.0.0.0:4000/articles/ski-2014/">Plotting data from the ski tracks app in R</a></li> <li><a href="http://0.0.0.0:4000/articles/pathsinr/">Plotting paths in R</a></li> <li><a href="http://0.0.0.0:4000/articles/dotplot/">Making a dotplot in R</a></li> </ul> </div> <hr/> <div class="entry-meta"> <meta itemprop="keywords" content="R, Great circles"> <span class="entry-tags"><a href="http://0.0.0.0:4000/tag/r/" title="R" class="tag" rel="tag">R</a><a href="http://0.0.0.0:4000/tag/great-circles/" title="Great circles" class="tag" rel="tag">Great circles</a></span> <span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person">Published by <span itemprop="name" class="fn"><a href="http://0.0.0.0:4000/about/" title="About James Black" itemprop="url">James Black</a></span> on </span> <span class="entry-date"><time datetime="2014-01-26T00:00:00+00:00" itemprop="datePublished" class="published">January 26, 2014</time></span> <span class="entry-date">(Updated <time datetime="2014-02-13" itemprop="dateModified" class="updated">02/13/2014</time>)</span> </div> </div> <div id="disqus_thread" class="entry-content"></div> <noscript><div class="upgrade">Please enable JavaScript to view comments.</div></noscript> </div> </article> </div> <div class="footer-wrapper"> <footer role="contentinfo"> <p>&#169; 2004&#8211;2014 <a href="http://0.0.0.0:4000/about/">James Black</a>, this site is written in markdown, compiled to html by jekyll, and hosted on github.pages.io. <a href="http://0.0.0.0:4000/humans.txt">Base theme here</a>.</p> <div class="social-icons"> <a href="http://github.com/epijim" title="James Black on Github" target="_blank"><i class="fa fa-github fa-fw fa-2x"></i></a> <a href="https://plus.google.com/112022213613617220776/" title="James Black on Google+" target="_blank"><i class="fa fa-google-plus-square fa-fw fa-2x"></i></a> </div> </footer> </div> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" data-cfasync="false"></script> <script data-cfasync="false">window.jQuery||document.write('<script src="http://0.0.0.0:4000/js/vendor/jquery-397754ba49e9e0cf4e7c190da78dda05.js"><\/script>');</script> <script src="http://0.0.0.0:4000/js/main.min-b1c052388578ab3b44858ccabf1f47d6.js"></script> <script>var _gaq=_gaq||[];var pluginUrl="//www.google-analytics.com/plugins/ga/inpage_linkid.js";_gaq.push(["_require","inpage_linkid",pluginUrl]);_gaq.push(["_setAccount",""]);_gaq.push(["_trackPageview"]);(function(){var c=document.createElement("script");c.type="text/javascript";c.async=true;c.src=("https:"==document.location.protocol?"https://":"http://")+"stats.g.doubleclick.net/dc.js";var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(c,d)})();</script> <script src="http://0.0.0.0:4000/js/vendor/modernizr-ab083e250330742e0b9d2a5548ea8745.js"></script> <script type="text/javascript">var disqus_shortname="jamesblack";var disqus_title="Facebook friend migrations";(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(b)})();</script> </body> </html>